(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["phone"],{"245a":function(t,e,o){"use strict";const s=[{ORG_ID:"1001",SIGNIN_CODE:"80001",ITEM_TYPE:"2",AGENT_ID:"",ICP_CODE:"70003",ORG_NAME:"深圳市建筑工务署",LONGITUDE:"113.951929",USER_STATE:"3",USER_NAME:"海关",PAR_ORG:"0",EMAIL:"123@qq.com",USER_CODE:"1",TRANSPORT:"",USER_TYPE:"3",SIGNIN_PWD:"cti-1234",REPORT_TIME:"2020-01-08 17:01:41",LATITUDE:"22.53153",USER_ACCOUNT:"wangyong",MOBILE:"13554326789",USER_ICON:"/Header/1.png"},{ORG_ID:"1001",ITEM_TYPE:"2",SIGNIN_CODE:"",AGENT_ID:"",ICP_CODE:"70002",ORG_NAME:"深圳市建筑工务署",LONGITUDE:"4.9E-324",USER_STATE:"3",USER_NAME:"xiehuadong",PAR_ORG:"0",EMAIL:"",USER_CODE:"32300",TRANSPORT:"",USER_TYPE:"3",SIGNIN_PWD:"",REPORT_TIME:"2019-12-20 17:20:07",LATITUDE:"4.9E-324",USER_ACCOUNT:"xiehuadong",MOBILE:"",USER_ICON:"/Header/32300.png"},{ORG_ID:"1001",SIGNIN_CODE:"",AGENT_ID:"",ITEM_TYPE:"2",ICP_CODE:"70001",ORG_NAME:"深圳市建筑工务署",USER_STATE:"3",USER_NAME:"lijiaming",PAR_ORG:"0",USER_CODE:"32306",TRANSPORT:"",USER_TYPE:"3",SIGNIN_PWD:"",USER_ACCOUNT:"lijiaming",USER_ICON:"/Header/32306.png"}],i=[{ORG_ID:"55",DEVICE_SHORT:"走廊西-东向",SITE_ID:"15",IS_VOICE:"1",IS_MOBILE:"0",ITEM_TYPE:"1",ORG_NAME:"深圳海关",TYPE_BAGD:"iconditu",LONGITUDE:"113.95",DEVICE_NAME:"走廊西-东向",SITE_NAME:"星网",DEVICE_CODE:"07530860000000000101#db862a982c8d4834ba4b47ed0287405d",P_NODE_ID:"4403",DISTRICT_SNO:"4403",DISTRICT_NAME:"深圳海关",TYPE_COL:"#e2b11c",TYPE_ID:"1",TYPE_ICO:"iconjiankong",TYPE_NAME:"监控",DEVICE_ID:"900067",LATITUDE:"22.53",ADDR_NAME:"广东省深圳市南山区粤海街道白石路3635号深圳湾科技生态园"},{ORG_ID:"55",DEVICE_SHORT:"办公A区东北",SITE_ID:"15",IS_VOICE:"1",ITEM_TYPE:"1",IS_MOBILE:"0",ORG_NAME:"深圳海关",TYPE_BAGD:"iconditu",LONGITUDE:"113.93",DEVICE_NAME:"办公A区东北",SITE_NAME:"星网",DEVICE_CODE:"05262240000000000101#db862a982c8d4834ba4b47ed0287405d",P_NODE_ID:"4403",DISTRICT_SNO:"4403",DISTRICT_NAME:"深圳海关",TYPE_COL:"#e2b11c",TYPE_ID:"1",TYPE_ICO:"iconjiankong",TYPE_NAME:"监控",DEVICE_ID:"900071",LATITUDE:"22.54",ADDR_NAME:"广东省深圳市南山区粤海街道深圳大学贮能材料研究中心深圳大学粤海校区",REMARK:"办公A区东北"},{ORG_ID:"54",DEVICE_SHORT:"公司无人机",IS_VOICE:"1",IS_MOBILE:"0",ITEM_TYPE:"1",ORG_NAME:"中国海关",TYPE_BAGD:"iconditu",DEVICE_NAME:"公司无人机",DEVICE_CODE:"8989",P_NODE_ID:"4403",DISTRICT_SNO:"4403",DISTRICT_NAME:"深圳海关",TYPE_COL:"#e2b11c",TYPE_ID:"1",TYPE_ICO:"iconjiankong",TYPE_NAME:"监控",DEVICE_ID:"910001"}];function n(){return s||[]}function r(){return i||[]}o.d(e,"b",(function(){return n})),o.d(e,"a",(function(){return r}))},"8ffa":function(t,e,o){},9545:function(t,e,o){"use strict";o.r(e);var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"phone-index-wrap"},[o("el-form",{ref:"phoneForm",attrs:{model:t.phoneModel,size:"small",inline:!0,rules:t.rules}},[o("el-form-item",{attrs:{label:"电话号码",prop:"phone"}},[o("el-input",{model:{value:t.phoneModel.phone,callback:function(e){t.$set(t.phoneModel,"phone",e)},expression:"phoneModel.phone"}})],1),o("el-form-item",[o("el-button",{attrs:{type:"primary",disabled:!t.phoneModel.phone},on:{click:t.callPhone}},[t._v("拨打电话")]),o("el-button",{attrs:{type:"danger",size:"small",disabled:!t.isCalling},on:{click:t.stopCall}},[t._v("挂断电话")])],1)],1)],1)},i=[];const n=/^(((13[0-9]{1})|(15[0-9]{1})|(16[0-9]{1})|(17[3-8]{1})|(18[0-9]{1})|(19[0-9]{1})|(14[5-7]{1}))+\d{8})$/;var r={name:"phoneIndex",data(){return{phoneModel:{phone:""},rules:{phone:[{required:!0,validator:this.phoneValidate,trigger:"change"}]},isCalling:!1}},created(){this.addPhoneListen()},methods:{phoneValidate(t,e,o){return e.trim()?n.test(e)?void o():o(new Error("手机号码格式不正确")):o(new Error("请输入手机号码"))},callPhone(){this.$refs.phoneForm.validate(async t=>{if(t){this.setLog({log:`开始执行拨打电话:${this.phoneModel.phone}`}),this.isCalling=!0;const t=await this.$xw.callout(this.phoneModel.phone);200===t.status?this.setLog({log:t.msg,action:`拨打电话成功: ${this.phoneModel.phone}`}):(this.setLog({log:t.msg,action:`拨打电话失败: ${this.phoneModel.phone}`}),this.$message.error(`拨打电话失败: ${this.phoneModel.phone},原因: ${t.msg}`),this.isCalling=!1)}})},stopCall(){},async addPhoneListen(){const t=await this.$xw.listen("OnLongNoAnswer",t=>{this.setLog({log:`对方久未应答: ${JSON.stringify(t)}`,action:"事件监听:OnLongNoAnswer"})});200===t.status?this.setLog({log:t.msg,action:"监听事件OnLongNoAnswer成功"}):this.setLog({log:`${t.msg}`,action:"监听事件OnLongNoAnswer失败"});const e=await this.$xw.listen("OnAnswerSuccess",t=>{this.setLog({log:`电话接听成功: ${JSON.stringify(t)}`,action:"事件监听:OnAnswerSuccess"})});200===e.status?this.setLog({log:e.msg,action:"监听事件OnAnswerSuccess成功"}):this.setLog({log:`${e.msg}`,action:"监听事件OnAnswerSuccess失败"});const o=await this.$xw.listen("OnAnswerRequest",t=>{this.setLog({log:`有来电信息: ${JSON.stringify(t)}`,action:"事件监听:OnAnswerRequest"})});200===o.status?this.setLog({log:o.msg,action:"监听事件OnAnswerRequest成功"}):this.setLog({log:`${o.msg}`,action:"监听事件OnAnswerRequest失败"});const s=await this.$xw.listen("OnReleaseSuccess",t=>{this.setLog({log:`通话挂断了: ${JSON.stringify(t)}`,action:"事件监听:OnReleaseSuccess"})});200===s.status?this.setLog({log:s.msg,action:"监听事件OnReleaseSuccess成功"}):this.setLog({log:`${s.msg}`,action:"监听事件OnReleaseSuccess失败"})}}},a=r,l=o("2877"),m=Object(l["a"])(a,s,i,!1,null,"526287b4",null);e["default"]=m.exports},aef2:function(t,e,o){"use strict";var s=o("8ffa"),i=o.n(s);i.a},b3e2:function(t,e,o){"use strict";o.r(e);var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"monitor-page-wrap"},[o("div",{staticClass:"left-form"},[o("div",{staticClass:"params-form"},[o("div",{staticClass:"title"},[t._v("输入设备参数打开监控")]),o("el-form",{ref:"monitorForm",attrs:{model:t.monitorForm,inline:!0,size:"mini",rules:t.rules,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"设备编号",prop:"resId"}},[o("el-input",{model:{value:t.monitorForm.resId,callback:function(e){t.$set(t.monitorForm,"resId",e)},expression:"monitorForm.resId"}})],1),o("el-form-item",{attrs:{label:"设备名称",prop:"name"}},[o("el-input",{model:{value:t.monitorForm.name,callback:function(e){t.$set(t.monitorForm,"name",e)},expression:"monitorForm.name"}})],1),o("el-form-item",{attrs:{label:"窗口位置x:",prop:"x"}},[o("el-input",{attrs:{type:"number"},model:{value:t.monitorForm.x,callback:function(e){t.$set(t.monitorForm,"x",t._n(e))},expression:"monitorForm.x"}})],1),o("el-form-item",{attrs:{label:"窗口位置y:",prop:"y"}},[o("el-input",{attrs:{type:"number"},model:{value:t.monitorForm.y,callback:function(e){t.$set(t.monitorForm,"y",t._n(e))},expression:"monitorForm.y"}})],1),o("el-form-item",{attrs:{label:"窗口宽度",prop:"width"}},[o("el-input",{attrs:{type:"number"},model:{value:t.monitorForm.width,callback:function(e){t.$set(t.monitorForm,"width",t._n(e))},expression:"monitorForm.width"}})],1),o("el-form-item",{attrs:{label:"窗口高度",prop:"height"}},[o("el-input",{attrs:{type:"number"},model:{value:t.monitorForm.height,callback:function(e){t.$set(t.monitorForm,"height",t._n(e))},expression:"monitorForm.height"}})],1)],1)],1),o("div",{staticClass:"btn-wraps"},[o("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.openMonitor}},[t._v("打开监控")])],1),o("hr"),o("div",{staticClass:"openmatrix"},[o("div",{staticClass:"title"},[t._v("矩阵监控")]),o("el-form",{attrs:{model:t.matrixForm,size:"small",inline:!0}},[o("el-form-item",{attrs:{label:"HOST",prop:"matrixHost"}},[o("el-input",{model:{value:t.matrixForm.matrixHost,callback:function(e){t.$set(t.matrixForm,"matrixHost",e)},expression:"matrixForm.matrixHost"}})],1),o("el-form-item",[o("el-button",{attrs:{type:"primary",disabled:t.openingMonitorList.length<2,size:"small"},on:{click:t.openMatrix}},[t._v("打开矩阵监控")])],1)],1),o("div",{staticClass:"tip"},[t._v("只有当前开打的监控超过两个才能打开矩阵监控")])],1)]),o("div",{staticClass:"right-table"},[o("el-table",{ref:"monitorTable",attrs:{border:"",size:"small",height:"500",data:t.monitorData}},[o("el-table-column",{attrs:{prop:"DEVICE_ID",label:"ID"}}),o("el-table-column",{attrs:{prop:"DEVICE_NAME",label:"设备名称"}}),o("el-table-column",{attrs:{prop:"DEVICE_CODE",label:"设备编号"}}),o("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[o("el-button",{attrs:{type:"primary",size:"small",disabled:!s.DEVICE_CODE},on:{click:function(e){return t.handleOpen(s)}}},[t._v("打开监控")])]}}])})],1)],1),o("div",{staticClass:"log-views"},t._l(t.selfLogs,(function(e,s){return o("div",{key:s,staticClass:"log-item",domProps:{innerHTML:t._s(e)}})})),0)])},i=[],n=o("245a"),r={name:"monitor",data(){return{monitorForm:{resId:"3001",name:"设备一",x:480,y:50,width:640,height:640},monitorData:[],rules:{resId:{required:!0,message:"必填项",trigger:"blur"},name:{required:!0,message:"必填项",trigger:"blur"},x:{type:"number",message:"必须位数字",trigger:"blur"},y:{type:"number",message:"必须位数字",trigger:"blur"},width:{type:"number",message:"必须位数字",trigger:"blur"},height:{type:"number",message:"必须位数字",trigger:"blur"}},openingMonitorList:[],matrixForm:{matrixHost:window.location.origin}}},created(){this.monitorData=Object(n["a"])(),this.initEventListen()},methods:{openMonitor(){this.$refs.monitorForm.validate(t=>{this.doOpenMonitor(this.monitorForm)})},async doOpenMonitor(t){this.setLog({log:"开始打开监控",action:`打开监控【openMonitor】:编号[${t.resId}]`});const e=await this.$xw.openMonitor(t);200===e.status?(this.$message.success(`打开编号[${t.resId}]监控成功`),this.openingMonitorList.push(t.resId),this.setLog({log:e.msg,action:`打开监控【openMonitor】成功: 编号[${t.resId}]`})):(this.$message.error(`打开监控失败: ${e.msg}`),this.setLog({log:e.msg,action:`打开监控【openMonitor】失败: 编号[${t.resId}]`}))},async openMatrix(){if(this.openingMonitorList.length<2)return this.$message.error("只有当前开打的监控超过两个才能打开矩阵监控");if(!this.matrixForm.matrixHost)return this.$message.error("请输入host");const t={host:this.matrixForm.matrixHost};this.setLog({log:"开始打开矩阵监控",action:"矩阵监控【enterMatrix】"});const e=await this.$xw.enterMatrix(t);200===e.status?(this.$message.success("打开矩阵监控成功"),this.setLog({log:e.msg,action:"打开矩阵监控【enterMatrix】成功"})):(this.$message.error(`打开矩阵监控失败: ${e.msg}`),this.setLog({log:e.msg,action:"打开矩阵监控【enterMatrix】失败"}))},colseMonitor(){},handleOpen(t){t.DEVICE_CODE&&this.doOpenMonitor({resId:t.DEVICE_CODE,name:t.DEVICE_NAME})},async initEventListen(){this.setLog({log:"开始监听监控关闭事件",action:"监听事件:[OnCloseMonitor]"});const t=await this.$xw.listen("OnCloseMonitor",t=>{this.setLog({log:t,action:"事件[OnCloseMonitor]收到消息"})});200===t.status?this.setLog({log:"监听事件【OnCloseMonitor】成功",action:"监听事件:[OnCloseMonitor]"}):this.setLog({log:"监听事件【OnCloseMonitor】失败",action:"监听事件:[OnCloseMonitor]"}),this.setLog({log:"开始监听监控矩阵关闭事件",action:"监听事件:[OnExitMatrix]"});const e=await this.$xw.listen("OnExitMatrix",t=>{this.setLog({log:t,action:"事件[OnExitMatrix]收到消息"})});200===e.status?this.setLog({log:"监听事件【OnExitMatrix】成功",action:"监听事件:[OnExitMatrix]"}):this.setLog({log:"监听事件【OnExitMatrix】失败",action:"监听事件:[OnExitMatrix]"})}}},a=r,l=(o("aef2"),o("2877")),m=Object(l["a"])(a,s,i,!1,null,"59a23abd",null);e["default"]=m.exports},e4f8:function(t,e,o){"use strict";o.r(e);var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"meeting-page-wrap"},[t._v("IM")])},i=[],n={name:"monitor",data(){return{}}},r=n,a=o("2877"),l=Object(a["a"])(r,s,i,!1,null,"6ba944a3",null);e["default"]=l.exports}}]);